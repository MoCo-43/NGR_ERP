<!DOCTYPE html>
<html
  lang="ko"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout/base}"
>
  <head>
    <meta charset="UTF-8" />
    <title layout:fragment="title">출하지시서 입력</title>

    <th:block layout:fragment="head_extra">
      <!-- Bootstrap -->
      <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
        rel="stylesheet"
      />
      <link
        href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
        rel="stylesheet"
      />

      <!-- AG Grid -->
      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/ag-grid-community@31.3.1/styles/ag-grid.css"
      />
      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/ag-grid-community@31.3.1/styles/ag-theme-quartz.css"
      />

      <style>
        .split-col {
          min-height: calc(100vh - 160px);
        }
        #orderGrid.ag-theme-quartz {
          height: 400px;
          width: 100%;
        }
        #itemGrid.ag-theme-quartz {
          height: 360px;
          width: 100%;
        }
        .summary-bar {
          font-weight: 600;
        }
      </style>
    </th:block>
  </head>
  <body>
    <section layout:fragment="content">
      <div class="container-fluid">
        <div class="row g-3">
          <!-- 좌측 주문서 조회 -->
          <div class="col-12 col-xl-5">
            <div class="card split-col">
              <div class="card-header py-2"><strong>주문서 조회</strong></div>
              <div class="card-body p-2">
                <div class="input-group input-group-sm mb-2">
                  <input
                    id="orderSearch"
                    type="text"
                    class="form-control"
                    placeholder="거래처/품목/번호"
                  />
                  <button id="btnOrderSearch" class="btn btn-outline-secondary">
                    검색
                  </button>
                </div>
                <div id="orderGrid" class="ag-theme-quartz w-100"></div>
              </div>
              <div class="card-footer py-2 text-end">
                <button id="btnApplyOrder" class="btn btn-primary btn-sm">
                  선택 적용 →
                </button>
              </div>
            </div>
          </div>

          <!-- 우측 출하지시서 입력 -->
          <div class="col-12 col-xl-7">
            <div class="card split-col">
              <div
                class="card-header d-flex justify-content-between align-items-center py-2"
              >
                <strong>출하지시서 입력</strong>
                <div class="d-flex gap-2">
                  <button
                    type="button"
                    class="btn btn-outline-secondary btn-sm"
                    id="btnReset"
                  >
                    <i class="bi bi-arrow-counterclockwise me-1"></i>초기화
                  </button>
                  <button
                    type="button"
                    class="btn btn-primary btn-sm"
                    id="btnSave"
                  >
                    <i class="bi bi-check2 me-1"></i>등록
                  </button>
                </div>
              </div>
              <div class="card-body">
                <!-- 기본 정보 폼 -->
                <div class="row g-2 mb-2">
                  <div class="col-md-6">
                    <label class="form-label mb-1">작성일자</label>
                    <input
                      type="date"
                      class="form-control form-control-sm"
                      id="writeDate"
                    />
                  </div>
                  <div class="col-md-6">
                    <label class="form-label mb-1">출하예정일</label>
                    <input
                      type="date"
                      class="form-control form-control-sm"
                      id="shipDate"
                    />
                  </div>
                  <div class="col-md-6">
                    <label class="form-label mb-1">거래처</label>
                    <input
                      type="text"
                      class="form-control form-control-sm"
                      id="customerName"
                    />
                  </div>
                  <div class="col-md-6">
                    <label class="form-label mb-1">담당자</label>
                    <input
                      type="text"
                      class="form-control form-control-sm"
                      id="managerName"
                    />
                  </div>
                  <div class="col-md-6">
                    <label class="form-label mb-1">연락처</label>
                    <input
                      type="text"
                      class="form-control form-control-sm"
                      id="phone"
                    />
                  </div>
                  <div class="col-md-6">
                    <label class="form-label mb-1">주소</label>
                    <input
                      type="text"
                      class="form-control form-control-sm"
                      id="address"
                    />
                  </div>
                </div>
                <!-- 품목 그리드 -->
                <div id="itemGrid" class="ag-theme-quartz"></div>
              </div>
              <div
                class="card-footer d-flex justify-content-between align-items-center py-2"
              >
                <div class="btn-group" role="group">
                  <button
                    type="button"
                    class="btn btn-outline-primary btn-sm"
                    id="btnAddRow"
                  >
                    행 추가
                  </button>
                  <button
                    type="button"
                    class="btn btn-outline-danger btn-sm"
                    id="btnDelRow"
                  >
                    선택 삭제
                  </button>
                  <button
                    type="button"
                    class="btn btn-outline-secondary btn-sm"
                    id="btnClearRows"
                  >
                    전체 비우기
                  </button>
                </div>
                <div class="summary-bar">
                  총 수량: <span id="sumQty">0</span> | 총 공급가액:
                  <span id="sumSupply">0</span> | 총 부가세:
                  <span id="sumVat">0</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <th:block layout:fragment="body_extra">
      <script
        src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"
      ></script>
      <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
      ></script>
      <script
        src="https://cdn.jsdelivr.net/npm/ag-grid-community@31.3.1/dist/ag-grid-community.min.noStyle.js"
      ></script>

      <script th:inline="none">
        document.addEventListener("DOMContentLoaded", () => {
          // TODO: orderGrid / itemGrid 각각 초기화, 선택 이벤트 연결, 등록 버튼 로직 작성
        });
      </script>
    </th:block>
  </body>
</html>
