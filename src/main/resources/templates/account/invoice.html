<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/base}">
<head>
<title layout:fragment="title">ë§¤ì… ë§¤ì¶œ ì „í‘œ</title>
<th:block layout:fragment="head_extra">

	<th:block
		th:replace="~{account/taxInvoiceModal :: taxInvoiceModalStyles}"></th:block>
	<!-- AG Grid -->
	<link rel="stylesheet"
		href="https://cdn.jsdelivr.net/npm/ag-grid-community@31.3.1/styles/ag-grid.css" />
	<link rel="stylesheet"
		href="https://cdn.jsdelivr.net/npm/ag-grid-community@31.3.1/styles/ag-theme-quartz.css" />
	<style>
#invoiceModal .voucher-switch {
	display: flex;
	align-items: center;
	gap: 0.75rem;
	font-weight: 700;
	font-size: 1.1rem; /* âœ… ê¸€ì í¬ê¸° í‚¤ì›€ */
	margin-bottom: 0.75rem;
}

#invoiceModal .voucher-switch .label {
	min-width: 48px;
	text-align: center;
	transition: color 0.3s ease;
}

#invoiceModal .voucher-switch .label.purchase {
	color: #1d4ed8; /* íŒŒë‘ */
}

#invoiceModal .voucher-switch .label.sales {
	color: #b91c1c; /* ë¹¨ê°• */
}

/* âœ… ì„ íƒ ìƒíƒœì¼ ë•Œ ìƒ‰ ë” ì§„í•˜ê²Œ */
#invoiceModal .switch input:not(:checked) ~ .label.purchase {
	color: #1d4ed8;
}

#invoiceModal .switch input:checked ~ .label.sales {
	color: #dc2626;
}

#invoiceModal .switch {
	position: relative;
	display: inline-block;
	width: 54px; /* ìŠ¤ìœ„ì¹˜ ì•½ê°„ í‚¤ì›€ */
	height: 28px;
}

#invoiceModal .switch input {
	display: none;
}

#invoiceModal .slider {
	position: absolute;
	cursor: pointer;
	inset: 0;
	background-color: #dbeafe;
	border-radius: 28px;
	transition: 0.3s;
}

#invoiceModal .slider::before {
	position: absolute;
	content: "";
	height: 22px;
	width: 22px;
	left: 3px;
	bottom: 3px;
	background-color: white;
	border-radius: 50%;
	transition: 0.3s;
}

/* ì²´í¬ ì‹œ ë§¤ì¶œ */
#invoiceModal .switch input:checked+.slider {
	background-color: #fee2e2;
}

#invoiceModal .switch input:checked+.slider::before {
	transform: translateX(26px);
}

#voucherGrid.ag-theme-quartz {
	height: 32rem;
	width: 100%;
}

#detailGrid.ag-theme-quartz {
	height: 14rem;
	width: 100%;
	margin-top: 1rem;
	display: none;
}

#invoiceGrid.ag-theme-quartz {
	height: 20rem;
	width: 100%;
	margin-top: 1rem;
}

#salesGrid.ag-theme-quartz {
	height: 20rem;
	width: 100%;
	margin-top: 1rem;
}

.btn-bar {
	display: flex;
	gap: 0.5rem;
	margin-bottom: 0.75rem;
}

/* âœ… 'ìœ í˜•' ì»¬ëŸ¼ë§Œ ë°°ì§€ ìŠ¤íƒ€ì¼ë¡œ ê°•ì¡° */
.badge-type {
	display: inline-block;
	padding: 0.125rem 0.5rem;
	border-radius: 9999px;
	font-weight: 700;
	font-size: 0.875rem;
	line-height: 1.2;
}

.badge-sales {
	background: #fee2e2;
	color: #b91c1c;
} /* ë§¤ì¶œ(S) ë¹¨ê°• */
.badge-purchase {
	background: #dbeafe;
	color: #1d4ed8;
} /* ë§¤ì…(P) íŒŒë‘ */
#btnRegisterDetail {
	display: none;
}

    /* ===========================
       âœ… ë¡œë”© ì˜¤ë²„ë ˆì´
    ============================ */
    .grid-loader {
      position: absolute;
      inset: 0;
      background: rgba(255, 255, 255, 0.92);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      transition: opacity 0.3s ease;
      backdrop-filter: blur(2px);
    }
    .grid-loader.hidden {
      opacity: 0;
      pointer-events: none;
    }

    /* ===========================
       âœ… ë¡œë”© ì½˜í…ì¸ 
    ============================ */
    .loader-content {
      text-align: center;
      color: #333;
    }

  
</style>
</th:block>
</head>
<body>
	<section layout:fragment="content">
		<div class="card shadow mb-3">
			<div
				class="card-header py-3 d-flex align-items-center justify-content-between">
				<h6 class="m-0 font-weight-bold text-primary">ë§¤ì¶œ/ë§¤ì… ì „í‘œ</h6>
			</div>
			<div class="card-body">
				<!-- ë²„íŠ¼ ì˜ì—­ -->
				<div class="btn-bar">
					<input type="date" class="form-control form-control-sm"
						id="fromDate" style="max-width: 180px" /> <span class="mx-1">~</span>
					<input type="date" class="form-control form-control-sm" id="toDate"
						style="max-width: 180px" />
					<button class="btn btn-dark btn-sm" id="btnSearch">ì¡°íšŒ</button>
					<button class="btn btn-primary btn-sm" data-bs-toggle="modal"
						data-bs-target="#invoiceModal">ë“±ë¡</button>
					<button id="openTaxInvoiceBtn" class="btn btn-success btn-sm">
						ì „ìì„¸ê¸ˆ</button>
				</div>
				<div id="invoiceGridWrapper" style="position:relative;">
				<!-- ì „í‘œ ëª©ë¡ Grid -->
				<div id="voucherGrid" class="ag-theme-quartz"></div>
				</div>
				<div id="actionBar" class="d-flex justify-content-end gap-2 my-2">
					<button id="btnRegisterDetail" type="button"
						class="btn btn-primary btn-sm">ë“±ë¡</button>
				</div>
				<!-- ë¶„ê°œ ìƒì„¸ Grid -->
				<div id="detailGrid" class="ag-theme-quartz"></div>
			</div>
		</div>
		<!-- âœ… ëª¨ë‹¬ fragment include -->

		<div th:replace="~{account/invoiceModal :: invoiceModal}"></div>
		<div th:replace="~{account/taxInvoiceModal :: taxInvoiceModal}"></div>
		<div th:replace="~{stock/modals/businessModal :: businessModal}"></div>
		<div th:replace="~{hr/codeLookup :: codeLookupModal}"></div>

	</section>

	<th:block layout:fragment="body_extra">
		<script
			src="https://cdn.jsdelivr.net/npm/ag-grid-community@31.3.1/dist/ag-grid-community.min.js"></script>
		<script
			src="https://cdn.jsdelivr.net/npm/axios@1.7.7/dist/axios.min.js"></script>
		<script th:inline="none">
const loginName = /*[[${#authentication.principal.empLoginVO.name}]]*/ "";
  let voucherApi, detailApi;
  let selectedInvoice = null; // âœ… í˜„ì¬ ì„ íƒí•œ ìƒë‹¨ ì „í‘œí–‰ ì €ì¥
  
  
  // compCodeë°›ì•„ë†“ê¸°
  axios.get("/api/v1/stock/getCompId", { withCredentials: true })
  .then(res => {
  		document.getElementById("compCode").value = res.data;
  	})
    .catch(err => console.error(err));
    
  // === ì „í‘œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ===
  async function loadAndRenderVoucher() {
	  showLoader("invoiceGridWrapper", "ì „í‘œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...");
	  try {
		    const fromDate = document.getElementById("fromDate").value;
		    const toDate   = document.getElementById("toDate").value;

		    const { data } = await axios.get("/api/account/headers");
		    let rows = Array.isArray(data) ? data : [];

		    // âœ… ê¸°ê°„ í•„í„° ì ìš©
		    if (fromDate) {
		      const from = new Date(fromDate);
		      rows = rows.filter(r => new Date(r.invoiceDate) >= from);
		    }
		    if (toDate) {
		      const to = new Date(toDate);
		      rows = rows.filter(r => new Date(r.invoiceDate) <= to);
		    }

		    voucherApi.setGridOption("rowData", rows);
		    voucherApi.refreshClientSideRowModel('sort');
		  } catch (err) {
		    console.error(err);
		    alert("ì „í‘œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");
		  } 
		  hideLoader("invoiceGridWrapper");
  }

  document.addEventListener("DOMContentLoaded", () => {
	  // âœ… ì˜¤ëŠ˜ ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ ì´ë²ˆ ë‹¬ 1ì¼~ì˜¤ëŠ˜ ë‚ ì§œ ê¸°ë³¸ ì„¸íŒ…
	  const today = new Date();
	  const yyyy = today.getFullYear();
	  const mm = String(today.getMonth() + 1).padStart(2, '0');
	  const dd = String(today.getDate()).padStart(2, '0');

	  const firstDay = `${yyyy}-${mm}-01`;
	  const todayStr = `${yyyy}-${mm}-${dd}`;

	  document.getElementById("fromDate").value = firstDay;
	  document.getElementById("toDate").value = todayStr;

	  // âœ… í˜ì´ì§€ ë¡œë“œì‹œ ìë™ì¡°íšŒ ì‹¤í–‰
	  loadAndRenderVoucher();
    // === voucherGrid ì •ì˜ ===
    const voucherColumnDefs = [
      { headerName: "ì›”", valueGetter: p => p.data?.invoiceDate ? new Date(p.data.createdAt).getMonth() + 1 : "", flex: .5 },
      { headerName: "ì¼", valueGetter: p => p.data?.invoiceDate ? new Date(p.data.createdAt).getDate() : "", flex: .5 },
      { headerName: "ì „í‘œë²ˆí˜¸", field: "invoiceNo", flex: 1 },

      // âœ… ìœ í˜• ì»¬ëŸ¼ë§Œ ë°°ì§€ë¡œ ë Œë”ë§
      {
        headerName: "ìœ í˜•",
        field: "type",
        flex: 1,
        cellRenderer: params => {
          const isSales = params.value === 'S';
          const text = isSales ? 'ë§¤ì¶œ' : 'ë§¤ì…';
          const cls  = isSales ? 'badge-sales' : 'badge-purchase';
          return `<span class="badge-type ${cls}">${text}</span>`;
        }
      },

      { headerName: "ê±°ë˜ì²˜ëª…", field: "cusName", flex: 1 },
      { headerName: "ê³µê¸‰ê°€ì•¡", field: "subtotalAmt", valueFormatter: p => p.value ? p.value.toLocaleString() : "", flex: 1 },
      { headerName: "ë¶€ê°€ì„¸", field: "vatAmt", valueFormatter: p => p.value ? p.value.toLocaleString() : "", flex: 1 },
      { headerName: "í•©ê³„", field: "totalAmt", valueFormatter: p => p.value ? p.value.toLocaleString() : "", flex: 1 }
    ];

    voucherApi = agGrid.createGrid(document.querySelector("#voucherGrid"), {
      columnDefs: voucherColumnDefs,
      rowData: [],
      rowSelection: "single",
      pagination: true,
      paginationPageSize: 12,
      defaultColDef: { filter: true, resizable: true },
      // âŒ í–‰ ì „ì²´ ê°•ì¡° ì—†ìŒ

      onRowClicked: e => {
    	selectedInvoice = e.data;  
        console.log(e.data);
        const details = createDetailsFromInvoice(e.data);
        detailApi.setGridOption("rowData", details);
        document.getElementById("detailGrid").style.display = "block";
        document.getElementById("btnRegisterDetail").style.display = "block";
     
      }
    });

    // === detailGrid ì •ì˜ ===
    const detailColumnDefs = [
      { headerName: "êµ¬ë¶„", field: "gbn", flex: 1 },
      { headerName: "ì½”ë“œ", field: "code", flex: 1 },
      { headerName: "ê³„ì •ê³¼ëª©", field: "acctName", flex: 1 },
      { headerName: "ê±°ë˜ì²˜ì½”ë“œ", field: "partnerCode", flex: 1 },
      { headerName: "ê±°ë˜ì²˜", field: "partner", flex: 1 },
      { headerName: "ì°¨ë³€(ì¶œê¸ˆ)", field: "debit", flex: 1,valueFormatter: p => p.value ? p.value.toLocaleString() : "" },
      { headerName: "ëŒ€ë³€(ì…ê¸ˆ)", field: "credit", flex: 1,valueFormatter: p => p.value ? p.value.toLocaleString() : "" },
      { headerName: "ì ìš”", field: "note", flex: 1, editable: true }
    ];

    detailApi = agGrid.createGrid(document.querySelector("#detailGrid"), {
      columnDefs: detailColumnDefs,
      rowData: [],
      defaultColDef: { resizable: true }
    });

    // === ìë™ ë¶„ê°œ í•¨ìˆ˜ ===
    function createDetailsFromInvoice(invoice) {
      let details = [];

      if (invoice.type === "S") { // ë§¤ì¶œ
        details.push({ gbn: "ì°¨ë³€", code: "108", acctName: "ì™¸ìƒë§¤ì¶œê¸ˆ", partnerCode: invoice.cusCode, partner: invoice.cusName, debit: invoice.totalAmt, credit: null, note: `${invoice.cusName} ë§¤ì¶œ` });
        details.push({ gbn: "ëŒ€ë³€", code: "401", acctName: "ìƒí’ˆë§¤ì¶œ", partnerCode: invoice.cusCode, partner: invoice.cusName, debit: null, credit: invoice.subtotalAmt, note: `${invoice.invoiceNo} ë§¤ì¶œì•¡` });
        if (invoice.vatAmt && invoice.vatAmt > 0) {
          details.push({ gbn: "ëŒ€ë³€", code: "255", acctName: "ë¶€ê°€ì„¸ì˜ˆìˆ˜ê¸ˆ", partnerCode: invoice.cusCode, partner: invoice.cusName, debit: null, credit: invoice.vatAmt, note: "ë¶€ê°€ì„¸" });
        }
      } else if (invoice.type === "P") { // ë§¤ì…
        details.push({ gbn: "ì°¨ë³€", code: "501", acctName: "ìƒí’ˆë§¤ì¶œì›ê°€", partnerCode: invoice.cusCode, partner: invoice.cusName, debit: invoice.subtotalAmt, credit: null, note: `${invoice.invoiceNo} ë§¤ì…` });
        if (invoice.vatAmt && invoice.vatAmt > 0) {
          details.push({ gbn: "ì°¨ë³€", code: "135", acctName: "ë¶€ê°€ì„¸ëŒ€ê¸‰ê¸ˆ", partnerCode: invoice.cusCode, partner: invoice.cusName, debit: invoice.vatAmt, credit: null, note: "ë¶€ê°€ì„¸" });
        }
        details.push({ gbn: "ëŒ€ë³€", code: "251", acctName: "ì™¸ìƒë§¤ì…ê¸ˆ", partnerCode: invoice.cusCode, partner: invoice.cusName, debit: null, credit: invoice.totalAmt, note: `${invoice.cusName} ì™¸ìƒ` });
      }

      return details;
    }
    document.getElementById("btnSearch").addEventListener("click", loadAndRenderVoucher);

  });
  


// ì˜¤ëŠ˜ ë‚ ì§œ
const todayStr = () => {
	  const d = new Date();
	  const mm = String(d.getMonth()+1).padStart(2,'0');
	  const dd = String(d.getDate()).padStart(2,'0');
	  return `${d.getFullYear()}-${mm}-${dd}`;
	};

// ë””í…Œì¼ ê·¸ë¦¬ë“œ ë“±ë¡ ë²„íŠ¼ -> ì¼ë°˜ ì „í‘œ
document.getElementById("btnRegisterDetail").addEventListener("click", async (data) => {
	 if (selectedInvoice?.postedFlag === 'Y') {
		    alert("ì´ë¯¸ ë“±ë¡ëœ ì „í‘œì…ë‹ˆë‹¤.");
		    return;
		  }
  // detailGrid ë°ì´í„° ìˆ˜ì§‘
  const details = [];
  detailApi.forEachNode(node => {
    details.push(node.data);
  });

  if (details.length === 0) {
    alert("ë¶„ê°œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
    return;
  }
  
	const { data: newNo } = await axios.get("/api/account/nextJrnNo"); 
    data.jrnNo = newNo;

  // payload êµ¬ì„±
  const payload = details.map((d, idx) => ({
  	
	jrnNo:data.jrnNo,
	lineNo:data.lineNo || null,
	jrnDate: data.jrnDate || todayStr(),
    acctCode: d.code,
    acctName: d.acctName,
    dcType: d.gbn === "ì°¨ë³€" ? "D" : "C",
    amount: d.debit ? d.debit : d.credit,
    remarks: d.note,
    cusCode: d.partnerCode,
    cusName: d.cusName,
    status: "open"
    
  }));
  try {
	    await axios.post("/api/account/journalList", payload);

	    // âœ… ì „í‘œ ìƒíƒœ ì—…ë°ì´íŠ¸ (posted_flag -> Y)
	    await axios.put(`/api/account/invoice/${selectedInvoice.invoiceCode}/posted`, {
	      postedFlag: "Y"
	    });

	    alert("ì €ì¥ ì™„ë£Œ!");
	    // í™”ë©´ë„ ë¦¬í”„ë ˆì‹œ
	    loadAndRenderVoucher();
	  } catch (err) {
	    console.error(err);
	    alert("ì €ì¥ ì‹¤íŒ¨");
	  }

});


</script>

		<!-- ë¶€ì„œ ëª¨ë‹¬ -->
		<script th:inline="none">
document.addEventListener('DOMContentLoaded', () => {
	
	
  const invoiceModalEl = document.getElementById('invoiceModal');
  const btn = invoiceModalEl?.querySelector('#btnDeptLookup');
  if (!btn) return;

  // ì¤‘ë³µ ë°”ì¸ë”© ë°©ì§€
  if (btn.dataset.bound === '1') return;
  btn.dataset.bound = '1';

  btn.addEventListener('click', (e) => {
    e.preventDefault();
    e.stopPropagation();

    CodeLookup.open({
      source: 'dept',
      title:  'ë¶€ì„œ ì„ íƒ',
      // í•„ìš”í•œëŒ€ë¡œ ì§€ì •
      // targetId: 'deptCodeInput',
      targetNameId: 'deptNameInput',
    });
  });
});

document.addEventListener('DOMContentLoaded', () => {
	  const invoiceModalEl = document.getElementById('invoiceModal');
	  const btn = invoiceModalEl?.querySelector('#btnBankLookup');
	  if (!btn) return;

	  // ì¤‘ë³µ ë°”ì¸ë”© ë°©ì§€
	  if (btn.dataset.bound === '1') return;
	  btn.dataset.bound = '1';

	  btn.addEventListener('click', (e) => {
	    e.preventDefault();
	    e.stopPropagation();

	    CodeLookup.open({
	      groupId: 'BK',
	      title:  'ì€í–‰ ì„ íƒ',
	      // í•„ìš”í•œëŒ€ë¡œ ì§€ì •
	      // targetId: 'deptCodeInput',
	      targetNameId: 'bankNameInput',
	    });
	  });
	});
	
	
	// ëª¨ë‹¬ ì˜¤í”ˆ ë²„íŠ¼
	document.getElementById("openTaxInvoiceBtn")?.addEventListener("click", async () => {
  if (!selectedInvoice) {
    alert("ì „í‘œë¥¼ ì„ íƒí•˜ì„¸ìš”.");
    return;
  }
//âœ… ğŸ”¥ ëª¨ë‹¬ ì—´ê¸° ì „ì— ì´ˆê¸°í™” ìˆ˜í–‰
  resetTaxInvoiceModal();
  const invoiceCode = selectedInvoice.invoiceCode;

  try {
    const res = await axios.get(`/api/account/invoice/${invoiceCode}`);
    const { header, lines } = res.data;
    
    if (header.type === "P") {
    	  // âœ… ë§¤ì… ì „ìì„¸ê¸ˆê³„ì‚°ì„œ (ê³µê¸‰ì = ê±°ë˜ì²˜, ê³µê¸‰ë°›ëŠ”ì = ìš°ë¦¬ íšŒì‚¬)
    	  document.getElementById("tiApprovalNo").textContent = header.bizNo || "-";
    	  document.getElementById("tiWriteDate").value = header.invoiceDate?.substring(0, 10);

    	  // ê³µê¸‰ì (ê±°ë˜ì²˜ ì •ë³´)
    	  document.getElementById("tiSuppBizNo").value = header.cusCode || "";
    	  document.getElementById("tiSuppName").value  = header.cusName || "";
    	  document.getElementById("tiSuppCeo").value   = header.buyerCeoName || "";
    	  document.getElementById("tiSuppAddr").value  = header.buyerAddr || "";
    	  document.getElementById("tiSuppType").value  = header.buyerBizType || "";
    	  document.getElementById("tiSuppBiz").value   = header.buyerBizCategory || "";
    	  document.getElementById("tiSuppEmail").value = header.buyerEmail || "";

    	} else if (header.type === "S") {
    	  // âœ… ë§¤ì¶œ ì „ìì„¸ê¸ˆê³„ì‚°ì„œ (ê³µê¸‰ì = ìš°ë¦¬ íšŒì‚¬, ê³µê¸‰ë°›ëŠ”ì = ê±°ë˜ì²˜)
    	  document.getElementById("tiApprovalNo").textContent = header.bizNo || "-";
    	  document.getElementById("tiWriteDate").value = header.invoiceDate?.substring(0, 10);


    	  // ê³µê¸‰ë°›ëŠ”ì (ê±°ë˜ì²˜)
    	  document.getElementById("tiBuyerBizNo").value  = header.cusCode || "";
    	  document.getElementById("tiBuyerName").value   = header.cusName || "";
    	  document.getElementById("tiBuyerCeo").value    = header.buyerCeoName || "";
    	  document.getElementById("tiBuyerAddr").value   = header.buyerAddr || "";
    	  document.getElementById("tiBuyerType").value   = header.buyerBizType || "";
    	  document.getElementById("tiBuyerBiz").value    = header.buyerBizCategory || "";
    	  document.getElementById("tiBuyerEmail").value  = header.buyerEmail || "";
    	}

    	// âœ… ê³µí†µ ì„¸íŒ… (ë§¤ì…/ë§¤ì¶œ ê³µí†µ)
    	document.getElementById("tiTotalAmt").value = header.totalAmt || 0;
    	document.getElementById("tiClaim").value    = header.totalAmt || 0;

    	// âœ… ë¼ì¸ ì„¸íŒ…
    	const tbody = document.getElementById("tiLines");
    	tbody.innerHTML = "";

    	(lines || []).forEach(line => {
    	  const tr = document.createElement("tr");
    	  tr.innerHTML = `
    	    <td class="center">${new Date(header.invoiceDate).getMonth() + 1}</td>
    	    <td class="center">${new Date(header.invoiceDate).getDate()}</td>
    	    <td>${line.productName || ""}</td>
    	    <td>${line.specification || ""}</td>
    	    <td class="right"><input type="number" value="${line.qty || 0}" style="width:100%;border:none;text-align:right"></td>
    	    <td class="right"><input type="number" value="${line.unitPrice || 0}" style="width:100%;border:none;text-align:right"></td>
    	    <td class="right ti-sup">${(line.supAmt || 0).toLocaleString()}</td>
    	    <td class="right ti-vat">${(line.vatAmt || 0).toLocaleString()}</td>
    	    <td>${line.note || ""}</td>
    	  `;
    	  tbody.appendChild(tr);
    	});
	
    // âœ… ë°ì´í„° ì„¸íŒ… ëë‚œ í›„ ëª¨ë‹¬ ì—´ê¸°
    bootstrap.Modal.getOrCreateInstance(document.getElementById("taxInvoiceModal")).show();

  } catch (err) {
    console.error("ì„¸ê¸ˆê³„ì‚°ì„œ ë°ì´í„° ì¡°íšŒ ì‹¤íŒ¨", err);
    alert("ì„¸ê¸ˆê³„ì‚°ì„œ ì¡°íšŒ ì‹¤íŒ¨");
  }
});
	
	
	function resetTaxInvoiceModal() {
		  // ëª¨ë“  input ì´ˆê¸°í™”
		  document.querySelectorAll('#taxInvoiceModal input').forEach(input => {
		    input.value = "";
		  });

		  // ìŠ¹ì¸ë²ˆí˜¸ ì´ˆê¸°í™”
		  document.getElementById("tiApprovalNo").textContent = "-";

		  // í’ˆëª© í–‰ ì‚­ì œ
		  const tbody = document.getElementById("tiLines");
		  if (tbody) tbody.innerHTML = "";

		  // í•©ê³„ ì˜ì—­ ì´ˆê¸°í™”
		  document.getElementById("tiTfootSupply").innerHTML = "<strong>0</strong>";
		  document.getElementById("tiTfootVat").innerHTML = "<strong>0</strong>";
		  document.getElementById("tiTotalAmt").value = "0";
		  document.getElementById("tiClaim").value = "0";
		}
</script>

	</th:block>
</body>
</html>
