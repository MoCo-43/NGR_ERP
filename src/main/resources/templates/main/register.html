<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main_auth_base}">
<head>
  <title layout:fragment="title">ERP 회원가입</title>

  <th:block layout:fragment="head_extra">
    <style>
      /* 전체 페이지 배경 */
      body {
        background-color: #f8f9fa;
      }

      .auth-forms {
        max-width: 720px; /* 폼 너비를 약간 줄여 안정감 부여 */
        margin: 3rem auto;
        padding: 3rem;
        background: #fff;
        border-radius: 12px;
        /* border: 1px solid #e5e7eb; */ /* 테두리 제거 */
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      }
      .auth-forms h2 {
        text-align: center;
        margin-bottom: 2.5rem;
        color: #1f2937;
        font-weight: 700;
        font-size: 2rem;
      }

      /* Flexbox 2열 레이아웃 */
      .form-row {
        display: flex;
        flex-wrap: wrap;
        gap: 1.5rem;
        margin-bottom: 1.25rem;
      }

      .form-row .input-field {
        flex: 1 1 calc(50% - 0.75rem);
        margin-bottom: 0;
      }
      
      .auth-forms .input-field {
        width: 100%;
        position: relative;
      }
      
      /* 입력 필드 레이블 스타일 */
      .auth-forms .input-field label {
          display: block;
          margin-bottom: 0.5rem;
          font-weight: 600;
          font-size: 0.9rem;
          color: #374151;
      }

      /* 입력 필드 스타일 */
      .auth-forms .input-field input {
        width: 100%;
        padding: 12px 16px;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        background-color: #f9fafb;
        outline: none;
        font-size: 1rem;
        color: #374151;
        transition: border-color 0.2s, box-shadow 0.2s;
      }
      .auth-forms .input-field input::placeholder {
        color: #9ca3af;
      }
      .auth-forms .input-field input:focus {
        border-color: #6d5b4f;
        background-color: #fff;
        box-shadow: 0 0 0 3px rgba(77, 52, 30, 0.1);
      }
      .auth-forms .input-field input[readonly] {
        background-color: #e5e7eb;
        cursor: not-allowed;
      }

      /* 입력 필드 내부에 버튼이 있을 경우, 텍스트가 겹치지 않도록 오른쪽 패딩 추가 */
      .input-field.has-button input {
          padding-right: 115px; /* 버튼 너비(100px) + 여백 */
      }

      /* 버튼 컨테이너 */
      .form-buttons {
        display: flex;
        gap: 1rem;
        margin-top: 2.5rem;
      }

      .form-buttons button {
        flex: 1;
        padding: 14px;
        border: none;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 600;
        border-radius: 8px;
        transition: all 0.2s;
      }

      /* 주요 버튼 */
      .btn-primary {
        background: #4d341e;
        color: #fff;
      }
      .btn-primary:hover {
        background: #3c2a1a;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      }
      
      /* 보조 버튼 */
      .btn-secondary {
        background: #fff;
        color: #374151;
        border: 1px solid #d1d5db;
      }
      .btn-secondary:hover {
        background: #f9fafb;
        border-color: #9ca3af;
      }

      .link-small {
        font-size: 0.9rem;
        text-align: center;
        margin-top: 1.5rem;
      }
      .link-small a {
        color: #4d341e;
        text-decoration: none;
        font-weight: 500;
      }
      .link-small a:hover {
        text-decoration: underline;
      }

      /* 인풋 내부 버튼 스타일 */
      .btn-find-address, .btn-check-username {
        position: absolute;
        right: 0;
        top: 2.1rem;
        bottom: 0;
        width: 100px; /* 버튼 너비 고정 */
        background-color: #e5e7eb;
        border: none;
        border-left: 1px solid #d1d5db;
        border-radius: 0 8px 8px 0;
        cursor: pointer;
        font-size: 0.9rem;
        font-weight: 500;
        color: #4b5563;
        transition: background-color 0.2s;
      }
       .btn-find-address:hover, .btn-check-username:hover {
        background-color: #d1d5db;
       }
    </style>
  </th:block>
</head>
<body>
<th:block layout:fragment="content">
<div class="auth-forms">
  <div id="register" class="auth-section active">
    <h2>회원가입</h2>
    <form th:action="@{/register}" method="post">
      <!-- 1행: 아이디, 회사코드 -->
      <div class="form-row">
        <div class="input-field has-button">
          <label for="username">아이디</label>
          <input type="text" id="username" name="username" placeholder="사용할 아이디를 입력하세요" required>
          <button type="button" class="btn-check-username">중복확인</button>
        </div>
        <div class="input-field">
          <label for="companyCode">회사코드</label>
          <input type="text" id="companyCode" name="companyCode" placeholder="회사코드를 입력하세요" required>
        </div>
      </div>

      <!-- 2행: 비밀번호, 비밀번호 재확인 -->
      <div class="form-row">
        <div class="input-field">
          <label for="password">비밀번호</label>
          <input type="password" id="password" name="password" placeholder="비밀번호를 입력하세요" required>
        </div>
        <div class="input-field">
          <label for="repassword">비밀번호 재확인</label>
          <input type="password" id="repassword" name="repassword" placeholder="비밀번호를 다시 입력하세요" required>
        </div>
      </div>

      <!-- 3행: CEO, 담당자 -->
      <div class="form-row">
        <div class="input-field">
          <label for="ceo">CEO</label>
          <input type="text" id="ceo" name="ceo" placeholder="대표자명을 입력하세요" required>
        </div>
        <div class="input-field">
          <label for="comManager">담당자</label>
          <input type="text" id="comManager" name="comManager" placeholder="담당자명을 입력하세요" required>
        </div>
      </div>

      <!-- 4행: 휴대폰, 이메일 -->
      <div class="form-row">
        <div class="input-field">
          <label for="phone">휴대폰</label>
          <input type="text" id="phone" name="phone" placeholder="휴대폰 번호를 입력하세요" required>
        </div>
        <div class="input-field">
          <label for="email">이메일</label>
          <input type="email" id="email" name="email" placeholder="이메일 주소를 입력하세요" required>
        </div>
      </div>

      <!-- 주소 관련 필드 -->
      <div class="form-row">
        <div class="input-field has-button">
          <label for="postcode">우편번호</label>
          <input type="text" id="postcode" name="postcode" placeholder="우편번호" readonly>
          <button type="button" onclick="execDaumPostcode()" class="btn-find-address">우편번호 찾기</button>
        </div>
        <div class="input-field">
          <label for="roadAddress">도로명주소</label>
          <input type="text" id="roadAddress" name="roadAddress" placeholder="도로명주소" readonly>
        </div>
      </div>
      <div class="form-row">
        <div class="input-field">
          <label for="jibunAddress">지번주소</label>
          <input type="text" id="jibunAddress" name="jibunAddress" placeholder="지번주소" readonly>
        </div>
        <div class="input-field">
          <label for="detailAddress">상세주소</label>
          <input type="text" id="detailAddress" name="detailAddress" placeholder="상세주소를 입력하세요">
        </div>
      </div>
      
      <!-- Daum Postcode 가이드 텍스트 -->
      <div class="input-field" style="margin: -1rem 0 1rem 0;">
        <span id="guide" style="color:#6b7280;display:none; padding-left: 5px; font-size: 0.85rem;"></span>
      </div>
      
      <input type="hidden" id="extraAddress" placeholder="참고항목">

      <!-- 가입/취소 버튼 -->
      <div class="form-buttons">
        <button type="button" class="btn-secondary" onclick="location.href='/login'">취소</button>
        <button type="submit" class="btn-primary">가입하기</button>
      </div>
    </form>
    <div class="link-small">
      <a href="/login">로그인으로 돌아가기</a>
    </div>
  </div>
</div>
</th:block>

<th:block layout:fragment="body_extra">
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script>
    function execDaumPostcode() {
        new daum.Postcode({
            oncomplete: function(data) {
                // 각 주소 변수 초기화
                var roadAddr = data.roadAddress; // 도로명 주소
                var extraRoadAddr = ''; // 참고 항목

                // 법정동명이 있을 경우 추가
                if(data.bname !== '' && /[동|로|가]$/g.test(data.bname)){
                    extraRoadAddr += data.bname;
                }
                // 건물명이 있고, 공동주택일 경우 추가
                if(data.buildingName !== '' && data.apartment === 'Y'){
                   extraRoadAddr += (extraRoadAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                }
                // 최종 참고항목 조합
                if(extraRoadAddr !== ''){
                    extraRoadAddr = ' (' + extraRoadAddr + ')';
                }

                // 우편번호와 주소 정보를 해당 필드에 삽입
                document.getElementById('postcode').value = data.zonecode;
                document.getElementById("roadAddress").value = roadAddr;
                document.getElementById("jibunAddress").value = data.jibunAddress;

                // 참고항목 삽입
                if(roadAddr !== ''){
                    document.getElementById("extraAddress").value = extraRoadAddr;
                } else {
                    document.getElementById("extraAddress").value = '';
                }

                // 가이드 메시지 처리
                var guideTextBox = document.getElementById("guide");
                if(data.autoRoadAddress) {
                    var expRoadAddr = data.autoRoadAddress + extraRoadAddr;
                    guideTextBox.innerHTML = '(예상 도로명 주소 : ' + expRoadAddr + ')';
                    guideTextBox.style.display = 'block';
                } else if(data.autoJibunAddress) {
                    var expJibunAddr = data.autoJibunAddress;
                    guideTextBox.innerHTML = '(예상 지번 주소 : ' + expJibunAddr + ')';
                    guideTextBox.style.display = 'block';
                } else {
                    guideTextBox.innerHTML = '';
                    guideTextBox.style.display = 'none';
                }
            }
        }).open();
    }
</script>
</th:block>
</body>
</html>

