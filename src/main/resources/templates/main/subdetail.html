<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>êµ¬ë… ìƒì„¸</title>
<script src="https://js.tosspayments.com/v2/standard"></script>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
	crossorigin="anonymous">
<link
	href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap"
	rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons"
	rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<style>

/* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
body {
	font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif;
	background-color: #f8f9fa;
	color: #333;
	margin: 0;
}

main {
	display: flex;
	justify-content: center;
	padding: 30px 20px;
	width: 100%;
	box-sizing: border-box;
}

.content-wrapper {
	width: 1400px;
	background-color: #fff;
	border: 1px solid #dee2e6;
	padding: 24px;
}

.page-title {
	text-align: center;
	font-size: 28px;
	font-weight: bold;
	margin-bottom: 20px;
}

.steps {
	display: flex;
	list-style: none;
	padding: 0 0 20px 0;
	margin: 0 0 24px 0;
	justify-content: space-evenly;
	border-bottom: 1px solid #e9ecef;
}

.steps .step {
	display: flex;
	align-items: center;
	color: #888;
}

.steps .step .number {
	width: 28px;
	height: 28px;
	border-radius: 50%;
	background-color: #adb5bd;
	color: white;
	display: flex;
	justify-content: center;
	align-items: center;
	margin-right: 8px;
	font-weight: bold;
	font-size: 14px;
}

.steps .step.active .number {
	background-color: #e53935;
}

.steps .step.completed .number {
	background-color: #3498db;
}

.steps .step.active span {
	color: #e53935;
	font-weight: bold;
}

.steps .step.completed span {
	color: #3498db;
}

.inner-layout {
	display: flex;
	gap: 32px;
}

.main-form, .subscription-form {
	flex: 2;
}

.sidebar {
	flex: 1;
	padding: 24px;
	background-color: #f8f9fa;
	border-radius: 4px;
}

.sidebar h3 {
	font-size: 18px;
	margin-top: 0;
	margin-bottom: 16px;
	padding-bottom: 12px;
	border-bottom: 1px solid #e9ecef;
}

.sidebar ul {
	padding-left: 20px;
	margin: 10px 0;
	line-height: 1.8;
	color: #495057;
}

.sidebar p {
	line-height: 1.8;
	color: #495057;
}

.form-section-label {
	font-size: 14px;
	font-weight: bold;
	color: #495057;
	margin-bottom: 8px;
	display: block;
}

.form-section-title {
	font-size: 18px;
	font-weight: bold;
	color: #333;
	margin-bottom: 24px;
	padding-bottom: 12px;
	border-bottom: 2px solid #e9ecef;
}

.form-group {
	margin-bottom: 24px;
}

.input-field {
	width: 100%;
	padding: 12px;
	border: 1px solid #ced4da;
	border-radius: 4px;
	font-size: 16px;
	box-sizing: border-box;
}

.input-field:read-only {
	background-color: #e9ecef;
	cursor: default;
}

.summary-box {
	border: 1px solid #e9ecef;
	border-radius: 4px;
}

.summary-box .summary-item {
	display: flex;
	justify-content: space-between;
	padding: 16px;
	border-bottom: 1px solid #e9ecef;
}

.summary-box .summary-item:last-child {
	border-bottom: none;
}

.summary-box .item-label {
	color: #495057;
}

.summary-box .item-value {
	font-weight: bold;
}

.summary-box .total {
	background-color: #f8f9fa;
	font-size: 18px;
}

.summary-box .total .item-value {
	color: #e53935;
}

.options-group {
	display: flex;
	gap: 12px;
	margin-bottom: 20px;
}

.service-display-box {
	flex: 1;
	padding: 16px;
	border: 1px solid #ced4da;
	background-color: #f8f9fa;
	text-align: center;
	border-radius: 4px;
	color: #495057;
}

.option-button, .payment-option {
	flex: 1;
	padding: 16px;
	border: 1px solid #ced4da;
	background-color: #fff;
	text-align: center;
	cursor: pointer;
	transition: all 0.2s;
	border-radius: 4px;
}

.option-button:hover, .payment-option:hover {
	border-color: #495057;
}

.option-button.selected, .payment-option.selected {
	border-color: #e53935;
	background-color: #fff3f2;
	color: #e53935;
	font-weight: bold;
}

.custom-select {
	width: 100%;
	padding: 12px;
	border: 1px solid #ced4da;
	border-radius: 4px;
	font-size: 16px;
	background-color: #fff;
	-webkit-appearance: none;
	-moz-appearance: none;
	appearance: none;
	background-image:
		url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e");
	background-repeat: no-repeat;
	background-position: right 0.75rem center;
	background-size: 16px 12px;
}

.premium-section {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 16px;
	border: 1px solid #dee2e6;
	margin-top: 24px;
}

.premium-section .label {
	font-weight: bold;
}

.premium-section .price {
	font-size: 18px;
	font-weight: bold;
	color: #e53935;
}

.form-navigation {
	display: flex;
	justify-content: space-between;
	margin-top: 32px;
}

.nav-btn {
	padding: 12px 24px;
	border: none;
	cursor: pointer;
	font-size: 16px;
	border-radius: 4px;
}

.prev-btn {
	background-color: #6c757d;
	color: white;
}

.next-btn {
	background-color: #e53935;
	color: white;
}

.completion-container {
	text-align: center;
	padding: 60px 20px;
}

.completion-container h2 {
	font-size: 24px;
	margin-bottom: 16px;
	color: #e53935;
}

.completion-container p {
	font-size: 16px;
	color: #495057;
	margin-bottom: 32px;
}

.completion-container .home-btn {
	background-color: #e53935;
	color: white;
	padding: 14px 40px;
	font-size: 18px;
	text-decoration: none;
	border-radius: 4px;
}

.step-section {
	display: none;
}

.step-section.active {
	display: block;
}

/* ì „ì ê³„ì•½ì„œ ìŠ¤íƒ€ì¼ */
#contract-document-wrapper {
	border: 1px solid #dee2e6;
	padding: 10px;
	height: 500px;
	overflow-y: auto;
	margin-bottom: 20px;
	background-color: #fff;
}

#contract-document {
	padding: 20px;
	line-height: 1.7;
	font-size: 14px;
	color: #333;
}

#contract-document h1 {
	text-align: center;
	font-size: 22px;
	margin-bottom: 24px;
	font-weight: bold;
}

#contract-document h2 {
	font-size: 18px;
	margin-top: 32px;
	margin-bottom: 16px;
	padding-bottom: 8px;
	border-bottom: 1px solid #e0e0e0;
	font-weight: bold;
}

#contract-document h3 {
	font-size: 16px;
	margin-bottom: 12px;
	font-weight: bold;
}

#contract-document p, #contract-document ul, #contract-document ol {
	margin-bottom: 16px;
}

#contract-document .introduction {
	text-align: center;
	margin-bottom: 32px;
	color: #555;
}

#contract-document ul, #contract-document ol {
	padding-left: 20px;
}

#contract-document strong {
	color: #000;
}

#contract-document .sub-list {
	margin-top: 8px;
	padding-left: 20px;
}
</style>
</head>
<body>
	<input type="hidden" id="base-users-hidden"
		th:value="${subPlan.baseSalary}">
	<input type="hidden" id="max-users-hidden"
		th:value="${subPlan.maxUsers}">
	<input type="hidden" id="min-users-hidden"
		th:value="${subPlan.minUsers}">
	<div th:replace="~{layout/main_header :: headerFragment}"></div>
	<div th:replace="~{modal/signModal :: signModal}"></div>
	<main>
		<div class="content-wrapper">
			<h1 class="page-title">êµ¬ë…ìƒì„¸</h1>

			<ol class="steps">
				<li id="step-ui-1" class="step active"><div class="number">1</div>
					<span>êµ¬ë…ì •ë³´</span></li>
				<li id="step-ui-2" class="step"><div class="number">2</div> <span>ì‚¬ìš©ìì •ë³´</span></li>
				<li id="step-ui-3" class="step"><div class="number">3</div> <span>ì „ì
						ê³„ì•½ì„œ</span></li>
				<li id="step-ui-4" class="step"><div class="number">4</div> <span>ê²°ì œ
						ë° ê²°ì œì™„ë£Œ</span></li>
			</ol>

			<div id="step-1" class="step-section active">
				<div class="inner-layout">
					<div class="subscription-form">
						<div class="form-group">
							<label class="form-section-label">ì œê³µ ì„œë¹„ìŠ¤</label>
							<div
								th:each="svc : ${#strings.arraySplit(subPlan.avaiModules, ',')}"
								class="service-display-box">
								<div th:text="${svc}"></div>
							</div>
						</div>
						<div class="form-group">
							<label class="form-section-label">êµ¬ë…ê¸°ê°„</label>
							<div class="options-group" id="duration-options">
								<div class="option-button" data-duration="3ê°œì›”">
									<div class="icon">ğŸ“…</div>
									<div>3ê°œì›”</div>
								</div>
								<div class="option-button selected" data-duration="6ê°œì›”">
									<div class="icon">ğŸ“…</div>
									<div>6ê°œì›”</div>
								</div>
								<div class="option-button" data-duration="12ê°œì›”">
									<div class="icon">ğŸ“…</div>
									<div>12ê°œì›”</div>
								</div>
							</div>
						</div>
						<div class="form-group">
							<label for="user-count-input" class="form-section-label">ì‚¬ìš©ì
								ìˆ˜(ê·œëª¨)</label> <input type="text" id="user-count-input"
								class="input-field" value="0" min="1"
								placeholder="ì‚¬ìš©í•  ì¸ì› ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.">
						</div>
						<div class="premium-section">
							<span class="label">í”„ë¦¬ë¯¸ì—„ 12ê°œì›” êµ¬ë… ê¸ˆì•¡</span> <span class="price"
								th:text="${subPlan.baseSalary}"></span></span>
						</div>
						<div class="form-navigation">
							<button type="button" class="nav-btn prev-btn" disabled>ì´ì „ë‹¨ê³„</button>
							<button type="button" class="nav-btn next-btn"
								onclick="goToStep(2)">ë‹¤ìŒë‹¨ê³„</button>
						</div>
					</div>
					<aside class="sidebar">
						<h3>ì œí’ˆì— ëŒ€í•œ ì„¤ëª…</h3>
						<p>
							<strong>êµ¬ë… ì•ˆë‚´</strong>
						</p>
						<ul>
							<li>ì›í•˜ëŠ” êµ¬ë… ê¸°ê°„ê³¼ íšŒì‚¬ ê·œëª¨(ì‚¬ìš©ì ìˆ˜)ì— ë§ëŠ” í”Œëœì„ ì„ íƒí•˜ì„¸ìš”.</li>
							<li><strong>12ê°œì›”</strong> êµ¬ë… ì‹œ <strong>10% í• ì¸</strong>ì´
								ì ìš©ë©ë‹ˆë‹¤.</li>
						</ul>
						<p>
							<strong>ì´ˆê³¼ ìš”ê¸ˆ ì •ì±…</strong>
						</p>
						<ul>
							<li>ì„ íƒí•œ í”Œëœì˜ ìµœëŒ€ ì¸ì›ì„ ì´ˆê³¼í•˜ì—¬ ì‚¬ìš©ìë¥¼ ì¶”ê°€í•  ê²½ìš°, ì¸ë‹¹ ì¶”ê°€ ìš”ê¸ˆì´ ë°œìƒí•©ë‹ˆë‹¤.</li>
						</ul>
						<p>
							<strong>ë‹¤ìŒ ë‹¨ê³„</strong>
						</p>
						<ul>
							<li>ì„ íƒ ì™„ë£Œ í›„ 'ë‹¤ìŒë‹¨ê³„'ë¥¼ ëˆ„ë¥´ë©´ ì „ì ê³„ì•½ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.</li>
						</ul>
					</aside>
				</div>
			</div>

			<div id="step-2" class="step-section">
				<div class="inner-layout">
					<div class="main-form">
						<h3 class="form-section-title">íšŒì‚¬ ì •ë³´ (ìë™ ì…ë ¥)</h3>
						<div class="form-group">
							<label for="company-name" class="form-section-label">íšŒì‚¬ëª…</label>
							<input type="text" id="compName" class="input-field"
								th:value="${company.compName}" readonly>
						</div>
						<div class="form-group">
							<label for="biz-reg-number" class="form-section-label">ì‚¬ì—…ì
								ë“±ë¡ë²ˆí˜¸</label> <input type="text" id="brm" class="input-field"
								th:value="${company.brm}" readonly>
						</div>
						<div class="form-group">
							<label for="ceo-name" class="form-section-label">ëŒ€í‘œìëª…</label> <input
								type="text" id="ceo" class="input-field"
								th:value="${company.ceo}" readonly>
						</div>
						<div class="form-group">
							<label class="form-section-label">íšŒì‚¬ ì£¼ì†Œ</label> <input
								type="text" id="compAddr" class="form-control"
								placeholder="ë„ë¡œëª…ì£¼ì†Œ" th:value="${company.compAddr}" readonly>
							<input type="text" id="compDelAddr" class="form-control"
								placeholder="ìƒì„¸ì£¼ì†Œ" th:value="${company.compDelAddr}" readonly>
						</div>

						<h3 class="form-section-title" style="margin-top: 48px;">ê´€ë¦¬ì
							ì •ë³´ (ìë™ ì…ë ¥)</h3>
						<div class="form-group">
							<label for="admin-name" class="form-section-label">ê´€ë¦¬ì ì´ë¦„</label>
							<input type="text" id="matName" class="input-field"
								th:value="${company.matName}" readonly>
						</div>
						<div class="form-group">
							<label for="admin-email" class="form-section-label">ê´€ë¦¬ì
								ì´ë©”ì¼ (ID)</label> <input type="email" id="matMail" class="input-field"
								th:value="${company.matMail}" readonly>
						</div>

						<div class="form-navigation">
							<button type="button" class="nav-btn prev-btn"
								onclick="goToStep(1)">ì´ì „ë‹¨ê³„</button>
							<button type="button" class="nav-btn next-btn"
								onclick="goToStep(3)">ì •ë³´ í™•ì¸ ë° ë‹¤ìŒë‹¨ê³„</button>
						</div>
					</div>

					<aside class="sidebar">
						<h3>ì„ íƒí•œ êµ¬ë… ì •ë³´</h3>
						<div class="summary-box">
							<div class="summary-item">
								<span class="item-label">êµ¬ë… ê¸°ê°„</span> <span class="item-value"
									id="summary-duration">6ê°œì›”</span>
							</div>
							<div class="summary-item">
								<span class="item-label">ì‚¬ìš©ì ìˆ˜</span> <span class="item-value"
									id="summary-user-count">50ëª…</span>
							</div>
							<div class="summary-item total">
								<span class="item-label">ê¸°ë³¸ ê²°ì œê¸ˆì•¡</span> <span class="price"
									th:text="${subPlan.baseSalary}"></span>
							</div>
						</div>
						<h3 style="margin-top: 24px;">ì•ˆë‚´</h3>
						<ul>
							<li>ì‚¬ìš©ì ì •ë³´ëŠ” í˜„ì¬ ë¡œê·¸ì¸ëœ ê³„ì •ì„ ê¸°ì¤€ìœ¼ë¡œ ìë™ ì…ë ¥ë©ë‹ˆë‹¤.</li>
							<li>ì •ë³´ ë³€ê²½ì´ í•„ìš”í•œ ê²½ìš°, ë§ˆì´í˜ì´ì§€ì—ì„œ ìˆ˜ì •í•´ ì£¼ì„¸ìš”.</li>
						</ul>
					</aside>
				</div>
				<script>
				   document.addEventListener('DOMContentLoaded', function() {
					   // ì‹¤ì œ comCode ê°’ì„ ì–´ë–»ê²Œ ê°€ì ¸ì˜¬ì§€ì— ëŒ€í•œ ë¡œì§ í•„ìš”
					   // ì˜ˆ: const companyCode = 'some-company-code'; 
					   // fetch('/api/subDetail?comCode=' + companyCode) ...
				   });
				</script>
			</div>

			<div id="step-3" class="step-section">
				<div id="contract-document-wrapper">
					<div id="contract-document">
						<h1>NGR_ERP ì„œë¹„ìŠ¤ ì´ìš©ê³„ì•½ì„œ</h1>
						<p class="introduction">ë³¸ ê³„ì•½ì„œëŠ” NGR_ERP ì„œë¹„ìŠ¤ ì´ìš©ê³¼ ê´€ë ¨í•˜ì—¬ í•„ìš”í•œ ì œë°˜ ì‚¬í•­ì„
							ê·œì •í•¨ì„ ëª©ì ìœ¼ë¡œ í•©ë‹ˆë‹¤.</p>

						<h2>ì œ1ì¥ ì´ì¹™</h2>
						<article>
							<h3>ì œ1ì¡° (ëª©ì )</h3>
							<p>ë³¸ ì•½ê´€ì€ ì—”ì§€ì•Œ(ì´í•˜ "íšŒì‚¬")ì´ ì œê³µí•˜ëŠ” NGR_ERP ì„œë¹„ìŠ¤(ì´í•˜ "ì„œë¹„ìŠ¤")ì˜ ì´ìš©ê³¼ ê´€ë ¨í•˜ì—¬
								íšŒì‚¬ì™€ ì´ìš©ì(ì´í•˜ "ê³ ê°")ì˜ ê¶Œë¦¬, ì˜ë¬´ ë° ì±…ì„ì‚¬í•­, ê¸°íƒ€ í•„ìš”í•œ ì‚¬í•­ì„ ê·œì •í•¨ì„ ëª©ì ìœ¼ë¡œ í•©ë‹ˆë‹¤.</p>
						</article>
						<article>
							<h3>ì œ2ì¡° (ìš©ì–´ì˜ ì •ì˜)</h3>
							<div class="article-content">
								<ul>
									<li><strong>ì„œë¹„ìŠ¤:</strong> íšŒì‚¬ê°€ ê³ ê°ì—ê²Œ ì œê³µí•˜ëŠ” ì „ì‚¬ì ìì›ê´€ë¦¬(ERP) ì‹œìŠ¤í…œ ë°
										ê´€ë ¨ ë¶€ê°€ ì„œë¹„ìŠ¤ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.</li>
									<li><strong>ê³ ê°:</strong> íšŒì‚¬ì™€ ì„œë¹„ìŠ¤ ì´ìš©ê³„ì•½ì„ ì²´ê²°í•˜ê³  íšŒì‚¬ê°€ ì œê³µí•˜ëŠ” ì„œë¹„ìŠ¤ë¥¼
										ì´ìš©í•˜ëŠ” ë²•ì¸ ë˜ëŠ” ê°œì¸ì‚¬ì—…ìë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.</li>
									<li><strong>ì´ìš©ìš”ê¸ˆ:</strong> ê³ ê°ì´ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ëŠ” ëŒ€ê°€ë¡œ íšŒì‚¬ì— ì§€ë¶ˆí•´ì•¼ í•˜ëŠ”
										ë¹„ìš©ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</li>
								</ul>
							</div>
						</article>
						<article>
							<h3>ì œ3ì¡° (ì•½ê´€ì˜ íš¨ë ¥ ë° ë³€ê²½)</h3>
							<div class="article-content">
								<ol>
									<li>ë³¸ ì•½ê´€ì€ ì„œë¹„ìŠ¤ë¥¼ ì‹ ì²­í•œ ê³ ê°ì´ ë™ì˜í•¨ìœ¼ë¡œì¨ íš¨ë ¥ì´ ë°œìƒí•©ë‹ˆë‹¤.</li>
									<li>íšŒì‚¬ëŠ” í•©ë¦¬ì ì¸ ì‚¬ìœ ê°€ ë°œìƒí•  ê²½ìš° ê´€ë ¨ ë²•ë ¹ì— ìœ„ë°°ë˜ì§€ ì•ŠëŠ” ë²”ìœ„ì—ì„œ ë³¸ ì•½ê´€ì„ ê°œì •í•  ìˆ˜
										ìˆìŠµë‹ˆë‹¤.</li>
									<li>íšŒì‚¬ê°€ ì•½ê´€ì„ ê°œì •í•  ê²½ìš°ì—ëŠ” ì ìš©ì¼ì ë° ê°œì •ì‚¬ìœ ë¥¼ ëª…ì‹œí•˜ì—¬ í˜„í–‰ì•½ê´€ê³¼ í•¨ê»˜ ì„œë¹„ìŠ¤ í™ˆí˜ì´ì§€ì—
										ê·¸ ì ìš©ì¼ì 7ì¼ ì´ì „ë¶€í„° ì ìš©ì¼ì ì „ì¼ê¹Œì§€ ê³µì§€í•©ë‹ˆë‹¤.</li>
								</ol>
							</div>
						</article>
						<h2>ì œ2ì¥ ì„œë¹„ìŠ¤ ì´ìš©ê³„ì•½</h2>
						<article>
							<h3>ì œ4ì¡° (ì´ìš©ê³„ì•½ì˜ ì„±ë¦½)</h3>
							<p>ì´ìš©ê³„ì•½ì€ ê³ ê°ì´ íšŒì‚¬ê°€ ì •í•œ ì†Œì •ì˜ ì ˆì°¨ì— ë”°ë¼ ì´ìš©ì‹ ì²­ì„ í•˜ê³ , íšŒì‚¬ê°€ ì´ì— ëŒ€í•´ ìŠ¹ë‚™í•¨ìœ¼ë¡œì¨
								ì²´ê²°ë©ë‹ˆë‹¤.</p>
						</article>
						<article>
							<h3>ì œ5ì¡° (ì„œë¹„ìŠ¤ì˜ ì œê³µ ë° ë³€ê²½)</h3>
							<div class="article-content">
								<ol>
									<li>íšŒì‚¬ëŠ” ê³„ì•½ì—ì„œ ì •í•œ ë°”ì— ë”°ë¼ ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤ë¥¼ ì§€ì†ì ìœ¼ë¡œ ì œê³µí•  ì˜ë¬´ê°€ ìˆìŠµë‹ˆë‹¤.</li>
									<li>ì„œë¹„ìŠ¤ì˜ ë‚´ìš©ì— ë³€ê²½ì´ ìˆì„ ê²½ìš°, íšŒì‚¬ëŠ” ì´ë¥¼ ê³ ê°ì—ê²Œ ì‚¬ì „ì— ê³µì§€í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.</li>
									<li>íšŒì‚¬ëŠ” ì •ê¸°ì ê²€, ì‹œìŠ¤í…œ ê°œì„  ë“±ì˜ ì‚¬ìœ ë¡œ ì„œë¹„ìŠ¤ ì œê³µì„ ì¼ì‹œì ìœ¼ë¡œ ì¤‘ë‹¨í•  ìˆ˜ ìˆìœ¼ë©°, ì´ ê²½ìš°
										ì‚¬ì „ì— ê³µì§€í•©ë‹ˆë‹¤.</li>
								</ol>
							</div>
						</article>
						<h2>ì œ3ì¥ ë‹¹ì‚¬ìì˜ ì˜ë¬´</h2>
						<article>
							<h3>ì œ6ì¡° (íšŒì‚¬ì˜ ì˜ë¬´)</h3>
							<div class="article-content">
								<ol>
									<li>íšŒì‚¬ëŠ” ê³ ê°ì˜ ì •ë³´ ë³´ì•ˆì„ ìœ„í•´ ìµœì„ ì„ ë‹¤í•˜ë©°, ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨ì„ ì¤€ìˆ˜í•©ë‹ˆë‹¤.</li>
									<li>íšŒì‚¬ëŠ” ì„œë¹„ìŠ¤ ì´ìš©ê³¼ ê´€ë ¨í•˜ì—¬ ê³ ê°ìœ¼ë¡œë¶€í„° ì œê¸°ëœ ì˜ê²¬ì´ë‚˜ ë¶ˆë§Œì´ ì •ë‹¹í•˜ë‹¤ê³  ì¸ì •ë  ê²½ìš°ì—ëŠ” ì´ë¥¼
										ì‹ ì†í•˜ê²Œ ì²˜ë¦¬í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.</li>
								</ol>
							</div>
						</article>
						<article>
							<h3>ì œ7ì¡° (ê³ ê°ì˜ ì˜ë¬´)</h3>
							<div class="article-content">
								<ol>
									<li>ê³ ê°ì€ ì„œë¹„ìŠ¤ ì´ìš©ì— ë”°ë¥¸ ì´ìš©ìš”ê¸ˆì„ ì§€ì •ëœ ê¸°ì¼ì— ë‚©ë¶€í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.</li>
									<li>ê³ ê°ì€ ë¶€ì—¬ë°›ì€ ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ì˜ ê´€ë¦¬ ì†Œí™€ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ëª¨ë“  ì±…ì„ì€ ê³ ê° ë³¸ì¸ì—ê²Œ
										ìˆìŠµë‹ˆë‹¤.</li>
									<li>ê³ ê°ì€ ì„œë¹„ìŠ¤ ì´ìš©ê³¼ ê´€ë ¨í•˜ì—¬ ë‹¤ìŒ ê° í˜¸ì˜ í–‰ìœ„ë¥¼ í•˜ì—¬ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤.
										<ul class="sub-list">
											<li>íƒ€ì¸ì˜ ì •ë³´ë¥¼ ë„ìš©í•˜ëŠ” í–‰ìœ„</li>
											<li>ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ì—¬ ì–»ì€ ì •ë³´ë¥¼ íšŒì‚¬ì˜ ì‚¬ì „ ìŠ¹ë‚™ ì—†ì´ ë³µì œ, ìœ í†µí•˜ê±°ë‚˜ ìƒì—…ì ìœ¼ë¡œ ì´ìš©í•˜ëŠ”
												í–‰ìœ„</li>
											<li>íšŒì‚¬ì˜ ì§€ì ì¬ì‚°ê¶Œì„ ì¹¨í•´í•˜ëŠ” í–‰ìœ„</li>
										</ul>
									</li>
								</ol>
							</div>
						</article>
						<h2>ì œ4ì¥ ê³„ì•½ì˜ í•´ì§€ ë° ì´ìš© ì œí•œ</h2>
						<article>
							<h3>ì œ8ì¡° (ê³„ì•½ì˜ í•´ì§€)</h3>
							<p>ê³ ê° ë˜ëŠ” íšŒì‚¬ëŠ” ë¶€ë“ì´í•œ ì‚¬ìœ ê°€ ìˆëŠ” ê²½ìš° ìƒëŒ€ë°©ì—ê²Œ ì„œë©´ í†µë³´í•¨ìœ¼ë¡œì¨ ë³¸ ê³„ì•½ì„ í•´ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
						</article>
						<article>
							<h3>ì œ9ì¡° (ì´ìš© ì œí•œ)</h3>
							<p>íšŒì‚¬ëŠ” ê³ ê°ì´ ë³¸ ì•½ê´€ì˜ ì˜ë¬´ë¥¼ ìœ„ë°˜í•˜ê±°ë‚˜ ì„œë¹„ìŠ¤ì˜ ì •ìƒì ì¸ ìš´ì˜ì„ ë°©í•´í•œ ê²½ìš°, ì„œë¹„ìŠ¤ ì´ìš©ì„
								ì œí•œí•˜ê±°ë‚˜ ê³„ì•½ì„ í•´ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
						</article>
						<h2>ì œ5ì¥ ì†í•´ë°°ìƒ ë° ë©´ì±…</h2>
						<article>
							<h3>ì œ10ì¡° (ì†í•´ë°°ìƒ)</h3>
							<p>ë‹¹ì‚¬ì ì¼ë°©ì´ ë³¸ ê³„ì•½ìƒì˜ ì˜ë¬´ë¥¼ ìœ„ë°˜í•˜ì—¬ ìƒëŒ€ë°©ì—ê²Œ ì†í•´ë¥¼ ì…íŒ ê²½ìš°, ê·€ì±…ì‚¬ìœ  ìˆëŠ” ë‹¹ì‚¬ìëŠ” ìƒëŒ€ë°©ì´
								ì…ì€ ì†í•´ë¥¼ ë°°ìƒí•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.</p>
						</article>
						<article>
							<h3>ì œ11ì¡° (ë©´ì±…)</h3>
							<div class="article-content">
								<ol>
									<li>ì²œì¬ì§€ë³€ ë˜ëŠ” ì´ì— ì¤€í•˜ëŠ” ë¶ˆê°€í•­ë ¥ìœ¼ë¡œ ì¸í•˜ì—¬ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•  ìˆ˜ ì—†ëŠ” ê²½ìš°ì—ëŠ” ì„œë¹„ìŠ¤ ì œê³µì—
										ê´€í•œ ì±…ì„ì´ ë©´ì œë©ë‹ˆë‹¤.</li>
									<li>íšŒì‚¬ëŠ” ê³ ê°ì˜ ê·€ì±…ì‚¬ìœ ë¡œ ì¸í•œ ì„œë¹„ìŠ¤ ì´ìš©ì˜ ì¥ì• ì— ëŒ€í•˜ì—¬ëŠ” ì±…ì„ì„ ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤.</li>
								</ol>
							</div>
						</article>
					</div>
				</div>
				<div class="form-navigation">
					<button type="button" class="nav-btn prev-btn"
						onclick="goToStep(2)">ì´ì „ë‹¨ê³„</button>
					<button type="button" class="nav-btn next-btn" id="signbtn">ê³„ì•½ì—
						ë™ì˜ ë° ë‹¤ìŒë‹¨ê³„</button>
				</div>
			</div>
			<script>
                document.getElementById("signbtn").addEventListener("click", () => {
                    openSignModal('main', saveSign);
                });

                async function saveSign(signPath) {
                    if (signMode === "main") {
                        const dataToSend = {
                            filePath: signPath,
                            docName: "ì „ì ì„œëª…"
                        };
                        try {
                            await axios.post('/api/main/sign', dataToSend);
                            bootstrap.Modal.getOrCreateInstance(document.getElementById('signModal')).hide();
                            goToStep(4);
                        } catch (error) {
                            console.error("ì„œëª… ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤:", error);
                            alert("ì„œëª… ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
                        }
                    }
                }
            </script>
			
			<div id="step-4" class="step-section">
				<div class="inner-layout">
					<div class="main-form">
						<div class="form-group">
							<label class="form-section-label">ìµœì¢… ê²°ì œ ì •ë³´</label>
							<div class="summary-box">
								<div class="summary-item">
									<span class="item-label">êµ¬ë… ê¸°ê°„</span> <span class="item-value"
										id="summary-duration-final">6ê°œì›”</span>
								</div>
								<div class="summary-item">
									<span class="item-label">ì‚¬ìš©ì ìˆ˜</span> <span class="item-value"
										id="summary-user-count-final">50ëª…</span>
								</div>
								<div class="summary-item">
									<span class="item-label">êµ¬ë…í”Œëœ ê¸ˆì•¡</span> <span class="price"
										th:text="${subPlan.baseSalary}"></span>
								</div>
								<div class="summary-item">
									<span class="item-label">ê¸°ë³¸ ê¸ˆì•¡</span> <span class="price"
										id="base-price-display"></span>
								</div>
								<div class="summary-item">
									<span class="item-label">í• ì¸ ê¸ˆì•¡</span> <span class="item-value"
										id="summary-discount-price">- 0ì›</span>
								</div>
								<div class="summary-item">
									<span class="item-label">ì´ˆê³¼ ê¸ˆì•¡</span> <span class="item-value"
										id="summary-excess-price">+ 0ì›</span>
								</div>
								<div class="summary-item">
									<span class="item-label">ë¯¸ë§Œ ê¸ˆì•¡</span> <span class="item-value"
										id="summary-underage-price">- 0ì›</span>
								</div>
								<div class="summary-item total">
									<span class="item-label">ì´ ê²°ì œ ê¸ˆì•¡</span> <span
										class="item-value" id="summary-total-payment">0ì›</span>
								</div>
							</div>
						</div>

						<div class="form-group">
							<label class="form-section-label">ê²°ì œ ë°©ì‹ ì„ íƒ</label>
							<div class="options-group" id="payment-type-options">
								<div class="payment-option selected" data-type="NORMAL">
									<span class="fw-bold">ì¼ë°˜ê²°ì œ</span>
									<div class="form-text">ì„ íƒí•œ ê¸°ê°„ë§Œí¼ í•œ ë²ˆì— ê²°ì œ</div>
								</div>
								<div class="payment-option" data-type="RECURRING">
									<span class="fw-bold">ì •ê¸°ê²°ì œ</span>
									<div class="form-text">ë§¤ì›” ìë™ ê²°ì œë¥¼ ìœ„í•œ ì¹´ë“œ ë“±ë¡</div>
								</div>
							</div>
						</div>
						
						<div class="form-navigation">
							<button type="button" class="nav-btn prev-btn"
								onclick="goToStep(3)">ì´ì „ë‹¨ê³„</button>
							<button type="button" class="nav-btn next-btn"
								id="payment-button">ê²°ì œí•˜ê¸°</button>
						</div>
					</div>
					<aside class="sidebar">
						<h3>ê²°ì œ ì•ˆë‚´</h3>
						<ul>
							<li>ê²°ì œëŠ” ì•ˆì „í•œ PGì‚¬ë¥¼ í†µí•´ ì§„í–‰ë©ë‹ˆë‹¤.</li>
							<li>ê²°ì œ ì™„ë£Œ í›„ ì¦‰ì‹œ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
							<li>ê²°ì œ ê´€ë ¨ ë¬¸ì˜ëŠ” ê³ ê°ì„¼í„°(1234-5678)ë¡œ ì—°ë½ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.</li>
						</ul>
					</aside>
				</div>
			</div>
			
			<div id="step-5" class="step-section">
				<div class="completion-container">
					<h2>ê²°ì œê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!</h2>
					<p>
						ì´ì œ ëª¨ë“  ì„œë¹„ìŠ¤ë¥¼ ì •ìƒì ìœ¼ë¡œ ì´ìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>ê´€ë¦¬ì ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ì—¬ ì„œë¹„ìŠ¤ë¥¼ ì‹œì‘í•´ ë³´ì„¸ìš”.
					</p>
					<div class="summary-box"
						style="width: 500px; margin: 0 auto 40px auto; text-align: left;">
						<div class="summary-item">
							<span class="item-label">êµ¬ë… í”Œëœ</span> <span class="item-value">í”„ë¦¬ë¯¸ì—„</span>
						</div>
						<div class="summary-item">
							<span class="item-label">êµ¬ë… ê¸°ê°„</span> <span class="item-value">2025-09-29
								~ 2026-03-28</span>
						</div>
					</div>
					<a href="/dashboard" class="home-btn">ì„œë¹„ìŠ¤ ì‹œì‘í•˜ê¸°</a>
				</div>
			</div>
		</div>
	</main>
	
	<div class="modal fade" id="paymentModal" tabindex="-1" aria-labelledby="paymentModalLabel" aria-hidden="true">
	    <div class="modal-dialog modal-lg">
	        <div class="modal-content">
	            <div class="modal-header">
	                <h5 class="modal-title" id="paymentModalLabel">ê²°ì œ ì§„í–‰</h5>
	                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
	            </div>
	            <div class="modal-body">
	                <div id="payment-method-widget-modal" style="min-height: 400px;"></div>
	                <div id="agreement-widget-modal" style="margin-top: 16px;"></div>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ì·¨ì†Œ</button>
	                <button type="button" class="nav-btn next-btn" id="modal-payment-button">ê²°ì œí•˜ê¸°</button>
	            </div>
	        </div>
	    </div>
	</div>

	<div th:replace="~{layout/main_footer :: footerFragment}"></div>

<script>
    // ------------------------------------
    //  1. ì „ì—­ ë³€ìˆ˜ ì„¤ì •
    // ------------------------------------
    let currentStep = 1;
    let selectedDuration = 6;
    let selectedDurationText = "6ê°œì›”";
    let selectedUserCount = 0;
    let basePriceFromDB = 0;
    let maxUsers = 0;
    let minUsers = 0;
    const USER_UNIT_PRICE = 5000;
    let finalPayment = 0;
    let adjustmentCharge = 0;

    // âœ¨ [ìˆ˜ì •ë¨] Toss Payments í‚¤ë¥¼ ê¸°ëŠ¥ë³„ë¡œ ë¶„ë¦¬í•˜ì—¬ ì •ì˜
    const widgetClientKey = "test_gck_docs_Ovk5rk1EwkEbP0W43n07xlzm"; // ì¼ë°˜ê²°ì œ(ê²°ì œìœ„ì ¯)ìš© í´ë¼ì´ì–¸íŠ¸ í‚¤
    const billingClientKey = "test_ck_D5GePWvyJnrK0W0k6q8gLzN97Eoq"; // ì •ê¸°ê²°ì œ(API)ìš© í† ìŠ¤ í…ŒìŠ¤íŠ¸ìš© í‚¤
    const customerKey = "USER_ERP_1001"; // ì‹¤ì œ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ê³ ìœ  IDë¡œ ë³€ê²½

    // âœ¨ [ìˆ˜ì •ë¨] ê¸°ëŠ¥ë³„ TossPayments ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì €ì¥í•  ë³€ìˆ˜
    let tossWidgetPayments; // ì¼ë°˜ê²°ì œìš©
    let tossBillingPayments; // ì •ê¸°ê²°ì œìš©
    let widgets; // ìœ„ì ¯ ê°ì²´ë¥¼ ë‹´ì„ ë³€ìˆ˜

    // ------------------------------------
    //  2. ê²°ì œ ê³„ì‚° í•¨ìˆ˜ (ë³€ê²½ ì—†ìŒ)
    // ------------------------------------
    function calculatePayment() {
        const unitPricePerUser = basePriceFromDB;
        const duration = selectedDuration;
        const userCount = parseInt(selectedUserCount) || 0;
        const maxCount = maxUsers;

        let baseUserInputPrice = unitPricePerUser * userCount * duration;
        let localAdjustmentCharge = 0;

        if (userCount > maxCount) {
            localAdjustmentCharge = (userCount - maxCount) * USER_UNIT_PRICE * duration;
        } else if (userCount < maxCount) {
            localAdjustmentCharge = -(maxCount - userCount) * USER_UNIT_PRICE * duration;
        }

        let discount = 0;
        if (duration === 12) {
            discount = Math.round(baseUserInputPrice * 0.1);
        }

        adjustmentCharge = localAdjustmentCharge;
        finalPayment = baseUserInputPrice - discount + adjustmentCharge;
        finalPayment = Math.max(0, finalPayment);

        document.getElementById('base-price-display').textContent = baseUserInputPrice.toLocaleString() + 'ì›';
        document.getElementById('summary-discount-price').textContent = '- ' + discount.toLocaleString() + 'ì›';

        if (adjustmentCharge > 0) {
            document.getElementById('summary-excess-price').textContent = '+' + adjustmentCharge.toLocaleString() + 'ì›';
            document.getElementById('summary-underage-price').textContent = '- 0ì›';
        } else if (adjustmentCharge < 0) {
            document.getElementById('summary-excess-price').textContent = '+ 0ì›';
            document.getElementById('summary-underage-price').textContent = adjustmentCharge.toLocaleString() + 'ì›';
        } else {
            document.getElementById('summary-excess-price').textContent = '+ 0ì›';
            document.getElementById('summary-underage-price').textContent = '- 0ì›';
        }

        document.getElementById('summary-total-payment').textContent = finalPayment.toLocaleString() + 'ì›';
    }

    // ------------------------------------
    //  3. UI ì—…ë°ì´íŠ¸ ë° í˜ì´ì§€ ì´ë™ í•¨ìˆ˜ (ë³€ê²½ ì—†ìŒ)
    // ------------------------------------
    function updateSummary() {
        const durationElements = document.querySelectorAll('#summary-duration, #summary-duration-final');
        durationElements.forEach(el => el.textContent = selectedDurationText);

        const userCountElements = document.querySelectorAll('#summary-user-count, #summary-user-count-final');
        const formattedCount = (parseInt(selectedUserCount) || 0).toLocaleString() + "ëª…";
        userCountElements.forEach(el => el.textContent = formattedCount);
    }

    function goToStep(stepNumber) {
        document.querySelectorAll('.step-section').forEach(el => el.classList.remove('active'));
        document.getElementById(`step-${stepNumber}`).classList.add('active');

        updateStepUI(stepNumber);
        currentStep = stepNumber;

        if (stepNumber >= 2 && stepNumber <= 4) {
            updateSummary();
            if (basePriceFromDB > 0) {
                calculatePayment();
            }
        }
    }
    
    function updateStepUI(targetStep) {
        const steps = document.querySelectorAll('.steps .step');
        const uiTargetStep = targetStep > 4 ? 4 : targetStep;

        steps.forEach((step, index) => {
            const stepIndex = index + 1;
            step.classList.remove('active', 'completed');
            if (stepIndex < uiTargetStep) {
                step.classList.add('completed');
            } else if (stepIndex === uiTargetStep) {
                step.classList.add('active');
            }
        });

        if (targetStep === 5) {
            const step4UI = document.getElementById('step-ui-4');
            if (step4UI) {
                step4UI.classList.remove('active');
                step4UI.classList.add('completed');
            }
        }
    }

    // ------------------------------------
    //  4. ê²°ì œ ì²˜ë¦¬ í•¨ìˆ˜ë“¤
    // ------------------------------------

    /**
     * "ì¼ë°˜ ê²°ì œ" ëª¨ë‹¬ì„ ì—´ê³  ìœ„ì ¯ì„ ë Œë”ë§í•©ë‹ˆë‹¤.
     */
    async function openPaymentModal() {
        try {
            // âœ¨ [ìˆ˜ì •ë¨] ì¼ë°˜ê²°ì œìš© ì¸ìŠ¤í„´ìŠ¤(tossWidgetPayments) ì‚¬ìš©
            widgets = tossWidgetPayments.widgets({ customerKey });

            await widgets.setAmount({
                currency: "KRW",
                value: finalPayment,
            });

            await Promise.all([
                widgets.renderPaymentMethods({
                    selector: "#payment-method-widget-modal",
                    variantKey: "DEFAULT",
                }),
                widgets.renderAgreement({
                    selector: "#agreement-widget-modal",
                    variantKey: "AGREEMENT"
                }),
            ]);

            const paymentModal = new bootstrap.Modal(document.getElementById('paymentModal'));
            paymentModal.show();

        } catch (error) {
            console.error("Toss Payments ìœ„ì ¯ ë Œë”ë§ ì‹¤íŒ¨:", error);
            alert("ê²°ì œì°½ì„ ì—¬ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
        }
    }

    /**
     * "ì •ê¸° ê²°ì œ(ë¹Œë§)"ë¥¼ ìœ„í•œ ì¹´ë“œ ë“±ë¡ì°½ì„ ìš”ì²­í•©ë‹ˆë‹¤.
     */
    async function requestBillingAuth() {
        const customerName = document.getElementById('matName').value || "ê¹€í† ìŠ¤";
        const customerEmail = document.getElementById('matMail').value || "customer@example.com";

        try {
            // âœ¨ [ìˆ˜ì •ë¨] ì •ê¸°ê²°ì œìš© ì¸ìŠ¤í„´ìŠ¤(tossBillingPayments) ì‚¬ìš©
            const payment = tossBillingPayments.payment({ customerKey });
            await payment.requestBillingAuth({
              method: "CARD",
              successUrl: window.location.origin + "/payment/billing-success",
              failUrl: window.location.origin + "/payment/fail",
              customerEmail: customerEmail,
              customerName: customerName,
            });
        } catch (error) {
            console.error("ì •ê¸°ê²°ì œ ì¹´ë“œ ë“±ë¡ ìš”ì²­ ì‹¤íŒ¨:", error);
            alert("ì¹´ë“œ ë“±ë¡ì°½ì„ ì—¬ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
        }
    }

    /**
     * ì„ íƒëœ ê²°ì œ ë°©ì‹ì— ë”°ë¼ ì ì ˆí•œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
     */
    function handlePaymentRequest() {
        const selectedOption = document.querySelector('#payment-type-options .payment-option.selected');
        const paymentType = selectedOption.getAttribute('data-type');

        if (paymentType === 'NORMAL') {
            openPaymentModal();
        } else if (paymentType === 'RECURRING') {
            requestBillingAuth();
        }
    }

    // ------------------------------------
    //  5. DOMContentLoaded ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
    // ------------------------------------
    document.addEventListener('DOMContentLoaded', async function() {

        // âœ¨ [ìˆ˜ì •ë¨] í˜ì´ì§€ ë¡œë“œ ì‹œ ê° ê¸°ëŠ¥ì— ë§ëŠ” í‚¤ë¡œ TossPayments ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±
        tossWidgetPayments = TossPayments(widgetClientKey);
        tossBillingPayments = TossPayments(billingClientKey);

        // --- (ì´í•˜ ì½”ë“œëŠ” ì´ì „ê³¼ ë™ì¼) ---
    	const basePriceElement = document.querySelector('.premium-section .price');
    	if (basePriceElement && basePriceElement.textContent) {
    	    const rawValue = basePriceElement.textContent.replace(/[^0-9]/g, '');
    	    basePriceFromDB = parseInt(rawValue, 10) || 0;
    	}

    	const maxUsersHidden = document.getElementById('max-users-hidden');
    	if (maxUsersHidden) maxUsers = parseInt(maxUsersHidden.value, 10) || 0;

    	const minUsersHidden = document.getElementById('min-users-hidden');
    	if (minUsersHidden) minUsers = parseInt(minUsersHidden.value, 10) || 0;

        document.getElementById(`step-${currentStep}`).classList.add('active');

        const durationButtons = document.querySelectorAll('#duration-options .option-button');
        durationButtons.forEach(button => {
            button.addEventListener('click', () => {
                durationButtons.forEach(btn => btn.classList.remove('selected'));
                button.classList.add('selected');
                selectedDurationText = button.getAttribute('data-duration');
                selectedDuration = parseInt(selectedDurationText.replace(/[^0-9]/g, '')) || 1;
                calculatePayment();
            });
        });

        const initialSelectedDuration = document.querySelector('#duration-options .option-button.selected');
        if (initialSelectedDuration) {
            selectedDurationText = initialSelectedDuration.getAttribute('data-duration');
            selectedDuration = parseInt(selectedDurationText.replace(/[^0-9]/g, '')) || 1;
        }

        const userCountInput = document.getElementById('user-count-input');
        if (userCountInput) {
            selectedUserCount = userCountInput.value.replace(/[^0-9]/g, '');
            userCountInput.addEventListener('input', () => {
                selectedUserCount = userCountInput.value.replace(/[^0-9]/g, '');
                calculatePayment();
            });
        }

        const paymentTypeOptions = document.querySelectorAll('#payment-type-options .payment-option');
        paymentTypeOptions.forEach(option => {
            option.addEventListener('click', () => {
                paymentTypeOptions.forEach(opt => opt.classList.remove('selected'));
                option.classList.add('selected');
            });
        });

        calculatePayment();

        document.getElementById('payment-button').addEventListener('click', handlePaymentRequest);

        document.getElementById('modal-payment-button').addEventListener('click', async function () {
            if (!widgets) {
                alert("ê²°ì œ ìœ„ì ¯ì´ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
                return;
            }

            const requestData = {
                subPlanNo: 1,
                userCount: selectedUserCount,
                duration: selectedDuration,
                finalAmount: finalPayment,
                adjustmentCharge: adjustmentCharge
            };

            try {
                const response = await axios.post('/payment/api/payment/prepare', requestData);
                const { orderId, orderName } = response.data;

                await widgets.requestPayment({
                    orderId: orderId,
                    orderName: orderName,
                    successUrl: window.location.origin + "/payment/success",
                    failUrl: window.location.origin + "/payment/fail",
                });

            } catch (error) {
                console.error("ê²°ì œ ìš”ì²­ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
                alert("ê²°ì œë¥¼ ì§„í–‰í•˜ëŠ” ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì½˜ì†”ì„ í™•ì¸í•´ ì£¼ì„¸ìš”.");
            }
        });
    });
</script>
</body>
</html>